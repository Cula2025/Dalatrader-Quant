# -*- coding: utf-8 -*-
from datetime import date
from pathlib import Path
import streamlit as st
from app.debug_banner import show as debug_banner
debug_banner('Debug 0.1')

# Branding (logo, fonter, CSS, page config)
try:
    from app.branding import apply as brand
except Exception:
    def brand(*a, **k): pass
brand(page_title="Dala Trader ‚Äì Home", page_icon="üêé")

# --- header med logoh√§st ist√§llet f√∂r emoji ---
from pathlib import Path as _P
try:
    from PIL import Image as _Image  # f√∂r ev. cropp
except Exception:
    _Image = None

_BASE = _P(__file__).resolve().parent         # /srv/trader/app
_ASSETS = _BASE / "assets"
_HORSE  = _ASSETS / "horse.png"
_LOGO   = _ASSETS / "logodaladrader.png"

# layout: liten ikon + titeltext
col1, col2 = st.columns([0.10, 1])
with col1:
    _img = _HORSE if _HORSE.exists() else _LOGO
    if _img.exists():
        if _Image is not None and _img == _LOGO:
            # croppa v√§nstra kvadraten ur fulla loggan (heuristik)
            try:
                _im = _Image.open(_img)
                w, h = _im.size
                m = min(w, h)
                _crop = _im.crop((0, 0, m, m))
                st.image(_crop, width=48)
            except Exception:
                st.image(str(_img), width=48)
        else:
            st.image(str(_img), width=48)
with col2:
    st.markdown('<h1 style="margin:0">Dala Trader</h1>', unsafe_allow_html=True)
# --- /header ---
st.caption("Kvantitativa verktyg f√∂r portf√∂ljer, optimering och backtesting.")

# Snabbl√§nkar (fungerar i nya Streamlit; annars informativ fallback)
st.markdown("### Snabbnavigering")
try:
    st.page_link("pages/2_Portfolio.py", label="üìà √ñppna Portfolio", icon="üíº")
    st.page_link("pages/0_Optimizer.py", label="‚öôÔ∏è √ñppna Optimizer", icon="‚öôÔ∏è")
    st.page_link("pages/1_Backtrack.py", label="‚è™ √ñppna Backtrack", icon="‚è™")
except Exception:
    st.info("Anv√§nd sidomenyn f√∂r att navigera till Portfolio/Optimizer/Backtrack.")

st.markdown("---")
st.subheader("Kom ig√•ng")
st.markdown(
    "- G√• till **Portfolio** f√∂r att k√∂ra profiler mot universum och j√§mf√∂ra mot Buy&Hold/OMXS30.\n"
    "- G√• till **Optimizer** f√∂r att hitta parametrar (RSI, breakout, stoploss m.m.).\n"
    "- G√• till **Backtrack** f√∂r att testa sparade profiler mot andra perioder."
)
